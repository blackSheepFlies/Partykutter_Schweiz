<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Swiss Boarding Pass – Abruf</title>
<style>
  :root{ --accent:#d40000; --label:#222; }
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; margin:0; background:#f6f6f6;}
  header{background:white; padding:14px 18px; border-bottom:1px solid #e5e5e5;}
  header h1{margin:0; font-size:18px}
  main{max-width:980px; margin:18px auto; padding:0 16px 28px; display:grid; gap:16px;}
  .card{background:#fff; border:1px solid #e7e7e7; border-radius:12px; box-shadow:0 1px 2px rgba(0,0,0,.03);}
  .row{display:flex; gap:10px; align-items:center}
  .pad{padding:16px}
  label{font-size:14px; color:var(--label); white-space:nowrap}
  input[type="text"]{flex:1; padding:12px 14px; border:1px solid #ddd; border-radius:10px; font-size:16px}
  button{appearance:none; border:1px solid var(--accent); background:var(--accent); color:#fff; padding:10px 14px; border-radius:10px; font-weight:600; cursor:pointer}
  .hint{padding:0 16px 16px; color:#666; font-size:12px}
</style>
</head>
<body>
<header><h1>Swiss Boarding Pass – Name eintragen & herunterladen</h1></header>

<main>
  <section class="card pad">
    <div class="row">
      <label for="name">Passenger Name:</label>
      <input id="name" type="text" placeholder="z. B. Pilot Minion" />
      <button id="download">Get your Boarding Pass</button>
    </div>
  </section>

  <p class="hint">Dein Boarding Pass wird nicht angezeigt, sondern direkt als Datei heruntergeladen.</p>
</main>

<script>
(() => {
  const BASE_IMAGE_URL = 'ticket_base.png';      // Ticket ohne Namen (PNG)
  const FONT_FAMILY = "'Helvetica Neue', Helvetica, Arial, system-ui, sans-serif";
  const FONT_WEIGHT = 700;
  const TEXT_COLOR = "#111";
  const STROKE = {show:true, width:4, color:"#ffffff"};
  const NAME_FONT_SIZE = 28;

  const els = {
    name: document.getElementById('name'),
    download: document.getElementById('download')
  };

  // Verstecktes Canvas (nicht im Layout sichtbar)
  const canvas = document.createElement('canvas');
  canvas.width = 1536;
  canvas.height = 1024;
  const ctx = canvas.getContext('2d');

  const img = new Image();
  img.src = BASE_IMAGE_URL;

  const baseX = 180; 
  const baseY = 293; 
  const labelText = "Passenger Name:";
  const gap = 20;

  function drawAndDownload(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

    ctx.font = `${FONT_WEIGHT} ${NAME_FONT_SIZE}px ${FONT_FAMILY}`;
    ctx.textBaseline = "top";
    ctx.fillStyle = TEXT_COLOR;

    const name = (els.name.value || '').trim();
    if (!name) return;

    const labelWidth = ctx.measureText(labelText).width;
    const nameX = baseX + labelWidth + gap;
    const nameY = baseY;

    if (STROKE.show){
      ctx.lineWidth = STROKE.width;
      ctx.strokeStyle = STROKE.color;
      ctx.strokeText(name, nameX, nameY);
    }
    ctx.fillText(name, nameX, nameY);

    // Download starten
    const a = document.createElement('a');
    const clean = (name || 'Passenger').replace(/[^\w\-äöüÄÖÜß ]+/g,'').trim().replace(/\s+/g,'_');
    a.download = `BoardingPass_${clean}.png`;
    a.href = canvas.toDataURL('image/png');
    a.click();
  }

  els.download.addEventListener('click', drawAndDownload);
})();
</script>
</body>
</html>
